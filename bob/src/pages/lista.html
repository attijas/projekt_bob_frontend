<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <table id="tabela">
        <thead>
            <tr>
                <th>
                    login
                </th>
                <th>
                    haslo
                </th>
                <th>
                    email
                </th>
                <th>
                    imie
                </th>
                <th>
                    nazwisko
                </th>
                <th>
                    wiek
                </th>
                <th>
                    status
                </th>
                <th>
                    zdjecie
                </th>
                <th>
                    opis
                </th>
            </tr>
        </thead>
        <tbody>
            
        </tbody>
    </table>

    <script>
        async function pobierzDaneZBackendu(){
            try{
                const response = await fetch("http://localhost:8080/api/uzytkownicy/wildcard", 
                {method: "GET", 
                headers: {
                    "Content-Type": "application/json"
                }
            });
            if(!response){
                alert("brak użytkowników");
            }
            const uzytkownicy= await response.json();
            zapelnijTabele(uzytkownicy)    
        }
            catch(error){
                alert("Wystapil blad "+error); 

            }
        }

        function zapelnijTabele(uzytkownicy){
            const tabela = document.getElementById("tabela");
            const tbody = tabela.querySelector("tbody");
            uzytkownicy.forEach(uzytkownik=>{
                const row = document.createElement("tr");
                const imgSrc = uzytkownik.zdjecie 
                    ? `data:image/jpeg;base64,${uzytkownik.zdjecie}`
                    : "https://via.placeholder.com/100";
                row.innerHTML = `
                <td>${uzytkownik.login}</td>
                <td>${uzytkownik.haslo}</td>
                <td>${uzytkownik.email}</td>
                <td>${uzytkownik.imie}</td>
                <td>${uzytkownik.nazwisko}</td>
                <td>${uzytkownik.wiek}</td>
                <td>${uzytkownik.status}</td>
                <td><img src="${imgSrc}" alt="Zdjęcie"></td>
                <td>${uzytkownik.opis}</td>
                `;
                tbody.appendChild(row);
            })
            
        }

        pobierzDaneZBackendu();

    </script>

</body>

</html>